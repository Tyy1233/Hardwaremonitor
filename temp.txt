def monitor_top_processes():
    # Get the top 5 processes by CPU usage
    top_processes = sorted(psutil.process_iter(), key=lambda p: p.cpu_percent(), reverse=True)[:5]

    # Format the output
    output = ""
    for p in top_processes:
        output += f"{p.name()}: {p.cpu_percent():.1f}% CPU\n"

    # Get the current time and format it as a string
    time_stamp = datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S')
    
    # Write the output to the text file
    with open("spikes.txt", "a") as f:
        f.write(f"[{time_stamp}] Top processes:\n{output}\n")



        monitor_top_processes()